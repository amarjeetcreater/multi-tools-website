<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP Geolocation Finder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
    crossorigin="anonymous"></script>
</head>
<body>
    <div id="header-placeholder"></div>

    <main class="container my-4">
        <h1 class="text-center mb-4">IP Geolocation Finder</h1>
        <div class="ad-section">
            <!-- Ad Space -->
            <p>Advertisement</p>
        </div>
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">IP Geolocation Finder Functionality</h5>
                <div class="mb-3">
                    <label for="ipAddress" class="form-label">Enter IP Address:</label>
                    <input type="text" class="form-control" id="ipAddress" placeholder="e.g., 8.8.8.8 or your current IP">
                </div>
                <div class="d-grid gap-2 d-md-block mb-3">
                    <button class="btn btn-primary me-2" id="locateBtn"><i class="fas fa-map-marker-alt"></i> Locate IP</button>
                    <button class="btn btn-danger" id="clearBtn"><i class="fas fa-times"></i> Clear</button>
                </div>
                <div class="mt-4" id="resultContainer" style="display: none;">
                    <h5>Geolocation Details:</h5>
                    <ul class="list-group">
                        <li class="list-group-item"><strong>IP Address:</strong> <span id="resultIp"></span> <button class="btn btn-sm btn-outline-secondary float-end copy-btn" data-target="resultIp"><i class="fas fa-copy"></i></button></li>
                        <li class="list-group-item"><strong>Country:</strong> <span id="resultCountry"></span> <button class="btn btn-sm btn-outline-secondary float-end copy-btn" data-target="resultCountry"><i class="fas fa-copy"></i></button></li>
                        <li class="list-group-item"><strong>Region:</strong> <span id="resultRegion"></span> <button class="btn btn-sm btn-outline-secondary float-end copy-btn" data-target="resultRegion"><i class="fas fa-copy"></i></button></li>
                        <li class="list-group-item"><strong>City:</strong> <span id="resultCity"></span> <button class="btn btn-sm btn-outline-secondary float-end copy-btn" data-target="resultCity"><i class="fas fa-copy"></i></button></li>
                        <li class="list-group-item"><strong>Latitude:</strong> <span id="resultLat"></span> <button class="btn btn-sm btn-outline-secondary float-end copy-btn" data-target="resultLat"><i class="fas fa-copy"></i></button></li>
                        <li class="list-group-item"><strong>Longitude:</strong> <span id="resultLon"></span> <button class="btn btn-sm btn-outline-secondary float-end copy-btn" data-target="resultLon"><i class="fas fa-copy"></i></button></li>
                        <li class="list-group-item"><strong>Organization:</strong> <span id="resultOrg"></span> <button class="btn btn-sm btn-outline-secondary float-end copy-btn" data-target="resultOrg"><i class="fas fa-copy"></i></button></li>
                    </ul>
                </div>
            </div>
        </div>
    </main>

    <div id="footer-placeholder"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
    <script src="../js/loadComponents.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const ipAddressInput = document.getElementById('ipAddress');
            const locateBtn = document.getElementById('locateBtn');
            const clearBtn = document.getElementById('clearBtn');
            const resultContainer = document.getElementById('resultContainer');
            const resultIp = document.getElementById('resultIp');
            const resultCountry = document.getElementById('resultCountry');
            const resultRegion = document.getElementById('resultRegion');
            const resultCity = document.getElementById('resultCity');
            const resultLat = document.getElementById('resultLat');
            const resultLon = document.getElementById('resultLon');
            const resultOrg = document.getElementById('resultOrg');

            const fetchGeolocation = async (ip) => {
                try {
                    const response = await fetch(`http://ip-api.com/json/${ip}`);
                    const data = await response.json();
                    if (data.status === 'success') {
                        resultIp.textContent = data.query;
                        resultCountry.textContent = data.country;
                        resultRegion.textContent = data.regionName;
                        resultCity.textContent = data.city;
                        resultLat.textContent = data.lat;
                        resultLon.textContent = data.lon;
                        resultOrg.textContent = data.org || data.isp || 'N/A';
                        resultContainer.style.display = 'block';
                    } else {
                        alert('Could not find geolocation for the provided IP address. ' + data.message);
                        resultContainer.style.display = 'none';
                    }
                } catch (error) {
                    console.error('Error fetching geolocation:', error);
                    alert('An error occurred while fetching geolocation data. Please try again.');
                    resultContainer.style.display = 'none';
                }
            };

            locateBtn.addEventListener('click', () => {
                const ip = ipAddressInput.value.trim();
                if (ip) {
                    fetchGeolocation(ip);
                } else {
                    alert('Please enter an IP address.');
                }
            });

            clearBtn.addEventListener('click', () => {
                ipAddressInput.value = '';
                resultContainer.style.display = 'none';
                resultIp.textContent = '';
                resultCountry.textContent = '';
                resultRegion.textContent = '';
                resultCity.textContent = '';
                resultLat.textContent = '';
                resultLon.textContent = '';
                resultOrg.textContent = '';
            });

            document.querySelectorAll('.copy-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const targetId = event.currentTarget.dataset.target;
                    const textToCopy = document.getElementById(targetId).textContent;
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        alert('Copied to clipboard!');
                    }).catch(err => {
                        console.error('Failed to copy: ', err);
                    });
                });
            });

            // Optional: Get user's current IP on load (requires a separate API call or server-side logic)
            // For simplicity, we'll leave this out for now.
        });
    </script>
</body>
</html>