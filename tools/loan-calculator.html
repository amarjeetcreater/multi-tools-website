<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loan Calculator - Multi-Tools</title>
    <meta name="description" content="Calculate loan payments, interest, and amortization schedules. Free online loan calculator for mortgages, personal loans, and more.">
    <meta name="keywords" content="loan calculator, mortgage calculator, payment calculator, interest calculator, amortization">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/style.css">
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
    crossorigin="anonymous"></script>
</head>
<body>
    <!-- Header Placeholder -->
    <div id="header-placeholder"></div>

    <div class="container mt-4">
        <div class="row">
            <div class="col-lg-8">
                <div class="tool-container">
                    <h1 class="tool-title">
                        <i class="fas fa-calculator"></i> Loan Calculator
                    </h1>
                    <p class="tool-description">
                        Calculate loan payments, interest, and create amortization schedules for mortgages, personal loans, auto loans, and more.
                    </p>

                    <!-- Tool Tabs -->
                    <ul class="nav nav-tabs" id="loanTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="payment-tab" data-bs-toggle="tab" data-bs-target="#payment" type="button" role="tab">
                                <i class="fas fa-dollar-sign"></i> Payment Calculator
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="amortization-tab" data-bs-toggle="tab" data-bs-target="#amortization" type="button" role="tab">
                                <i class="fas fa-table"></i> Amortization Schedule
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="affordability-tab" data-bs-toggle="tab" data-bs-target="#affordability" type="button" role="tab">
                                <i class="fas fa-home"></i> Affordability Calculator
                            </button>
                        </li>
                    </ul>

                    <div class="tab-content mt-3" id="loanTabContent">
                        <!-- Payment Calculator Tab -->
                        <div class="tab-pane fade show active" id="payment" role="tabpanel">
                            <div class="card">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="loanAmount" class="form-label">Loan Amount</label>
                                                <div class="input-group">
                                                    <span class="input-group-text">$</span>
                                                    <input type="number" class="form-control" id="loanAmount" placeholder="Enter loan amount" step="0.01">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="interestRate" class="form-label">Annual Interest Rate</label>
                                                <div class="input-group">
                                                    <input type="number" class="form-control" id="interestRate" placeholder="Enter interest rate" step="0.01">
                                                    <span class="input-group-text">%</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="loanTerm" class="form-label">Loan Term</label>
                                                <div class="input-group">
                                                    <input type="number" class="form-control" id="loanTerm" placeholder="Enter term">
                                                    <select class="form-select" id="termType">
                                                        <option value="years">Years</option>
                                                        <option value="months">Months</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="paymentFrequency" class="form-label">Payment Frequency</label>
                                                <select class="form-select" id="paymentFrequency">
                                                    <option value="monthly">Monthly</option>
                                                    <option value="biweekly">Bi-weekly</option>
                                                    <option value="weekly">Weekly</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="btn btn-primary" onclick="calculatePayment()">
                                        <i class="fas fa-calculator"></i> Calculate Payment
                                    </button>
                                    <button class="btn btn-secondary" onclick="resetPayment()">
                                        <i class="fas fa-redo"></i> Reset
                                    </button>
                                </div>
                            </div>

                            <!-- Results -->
                            <div id="paymentResults" class="mt-4" style="display: none;">
                                <div class="card">
                                    <div class="card-header">
                                        <h5><i class="fas fa-chart-pie"></i> Payment Summary</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="result-item">
                                                    <span class="result-label">Monthly Payment:</span>
                                                    <span class="result-value" id="monthlyPayment"></span>
                                                </div>
                                                <div class="result-item">
                                                    <span class="result-label">Total Interest:</span>
                                                    <span class="result-value" id="totalInterest"></span>
                                                </div>
                                                <div class="result-item">
                                                    <span class="result-label">Total Amount:</span>
                                                    <span class="result-value" id="totalAmount"></span>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="result-item">
                                                    <span class="result-label">Interest Rate (Monthly):</span>
                                                    <span class="result-value" id="monthlyRate"></span>
                                                </div>
                                                <div class="result-item">
                                                    <span class="result-label">Number of Payments:</span>
                                                    <span class="result-value" id="numPayments"></span>
                                                </div>
                                                <div class="result-item">
                                                    <span class="result-label">Interest to Principal Ratio:</span>
                                                    <span class="result-value" id="interestRatio"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Amortization Schedule Tab -->
                        <div class="tab-pane fade" id="amortization" role="tabpanel">
                            <div class="card">
                                <div class="card-body">
                                    <p class="text-muted">Use the payment calculator above first, then view the amortization schedule here.</p>
                                    <div id="amortizationSchedule" class="mt-3">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-hover" id="amortizationTable">
                                                <thead class="table-dark">
                                                    <tr>
                                                        <th>Payment #</th>
                                                        <th>Payment</th>
                                                        <th>Principal</th>
                                                        <th>Interest</th>
                                                        <th>Balance</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="amortizationBody">
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <button class="btn btn-success" onclick="downloadAmortization()" id="downloadBtn" style="display: none;">
                                        <i class="fas fa-download"></i> Download Schedule
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Affordability Calculator Tab -->
                        <div class="tab-pane fade" id="affordability" role="tabpanel">
                            <div class="card">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="monthlyIncome" class="form-label">Monthly Income</label>
                                                <div class="input-group">
                                                    <span class="input-group-text">$</span>
                                                    <input type="number" class="form-control" id="monthlyIncome" placeholder="Enter monthly income" step="0.01">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="downPayment" class="form-label">Down Payment</label>
                                                <div class="input-group">
                                                    <span class="input-group-text">$</span>
                                                    <input type="number" class="form-control" id="downPayment" placeholder="Enter down payment" step="0.01">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="affordabilityRate" class="form-label">Interest Rate</label>
                                                <div class="input-group">
                                                    <input type="number" class="form-control" id="affordabilityRate" placeholder="Enter interest rate" step="0.01">
                                                    <span class="input-group-text">%</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="mb-3">
                                                <label for="loanTermAfford" class="form-label">Loan Term (Years)</label>
                                                <input type="number" class="form-control" id="loanTermAfford" placeholder="Enter loan term" value="30">
                                            </div>
                                        </div>
                                    </div>
                                    <button class="btn btn-primary" onclick="calculateAffordability()">
                                        <i class="fas fa-calculator"></i> Calculate Affordability
                                    </button>
                                    <button class="btn btn-secondary" onclick="resetAffordability()">
                                        <i class="fas fa-redo"></i> Reset
                                    </button>
                                </div>
                            </div>

                            <!-- Affordability Results -->
                            <div id="affordabilityResults" class="mt-4" style="display: none;">
                                <div class="card">
                                    <div class="card-header">
                                        <h5><i class="fas fa-home"></i> Affordability Analysis</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="result-item">
                                                    <span class="result-label">Maximum Home Price:</span>
                                                    <span class="result-value" id="maxHomePrice"></span>
                                                </div>
                                                <div class="result-item">
                                                    <span class="result-label">Maximum Loan Amount:</span>
                                                    <span class="result-value" id="maxLoanAmount"></span>
                                                </div>
                                                <div class="result-item">
                                                    <span class="result-label">Monthly Payment:</span>
                                                    <span class="result-value" id="affordabilityPayment"></span>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="result-item">
                                                    <span class="result-label">Debt-to-Income Ratio:</span>
                                                    <span class="result-value" id="dtiRatio"></span>
                                                </div>
                                                <div class="result-item">
                                                    <span class="result-label">Recommended Home Price:</span>
                                                    <span class="result-value" id="recommendedPrice"></span>
                                                </div>
                                                <div class="result-item">
                                                    <span class="result-label">Monthly Income Needed:</span>
                                                    <span class="result-value" id="incomeNeeded"></span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-lg-4">
                <div class="sidebar">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5><i class="fas fa-info-circle"></i> Loan Calculator Tips</h5>
                        </div>
                        <div class="card-body">
                            <ul class="list-unstyled">
                                <li><i class="fas fa-check text-success"></i> Use monthly income for affordability calculations</li>
                                <li><i class="fas fa-check text-success"></i> Consider property taxes and insurance</li>
                                <li><i class="fas fa-check text-success"></i> Aim for DTI ratio under 43%</li>
                                <li><i class="fas fa-check text-success"></i> Compare different loan terms</li>
                                <li><i class="fas fa-check text-success"></i> Factor in closing costs</li>
                            </ul>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header">
                            <h5><i class="fas fa-calculator"></i> Loan Formulas</h5>
                        </div>
                        <div class="card-body">
                            <h6>Monthly Payment Formula:</h6>
                            <p class="small">P = L[c(1 + c)^n]/[(1 + c)^n - 1]</p>
                            <p class="small">Where:</p>
                            <ul class="small">
                                <li>P = Monthly Payment</li>
                                <li>L = Loan Amount</li>
                                <li>c = Monthly Interest Rate</li>
                                <li>n = Total Number of Payments</li>
                            </ul>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-chart-line"></i> Loan Types</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <h6>Fixed-Rate Mortgage</h6>
                                <p class="small">Interest rate remains constant throughout the loan term.</p>
                            </div>
                            <div class="mb-3">
                                <h6>Adjustable-Rate Mortgage</h6>
                                <p class="small">Interest rate can change periodically based on market conditions.</p>
                            </div>
                            <div class="mb-3">
                                <h6>FHA Loans</h6>
                                <p class="small">Government-backed loans with lower down payment requirements.</p>
                            </div>
                            <div>
                                <h6>VA Loans</h6>
                                <p class="small">Veterans Affairs loans with favorable terms for eligible borrowers.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Main JS -->
    <script src="../js/main.js"></script>

    <script>
        let currentAmortizationData = [];

        function calculatePayment() {
            const loanAmount = parseFloat(document.getElementById('loanAmount').value);
            const annualRate = parseFloat(document.getElementById('interestRate').value);
            const loanTerm = parseFloat(document.getElementById('loanTerm').value);
            const termType = document.getElementById('termType').value;
            const paymentFreq = document.getElementById('paymentFrequency').value;

            if (!loanAmount || !annualRate || !loanTerm) {
                MultiTools.showError('Please fill in all required fields.');
                return;
            }

            // Convert to monthly values
            const monthlyRate = annualRate / 100 / 12;
            let numPayments;
            
            if (termType === 'years') {
                numPayments = loanTerm * 12;
            } else {
                numPayments = loanTerm;
            }

            // Calculate monthly payment
            const monthlyPayment = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numPayments)) / 
                                 (Math.pow(1 + monthlyRate, numPayments) - 1);

            const totalAmount = monthlyPayment * numPayments;
            const totalInterest = totalAmount - loanAmount;
            const interestRatio = ((totalInterest / loanAmount) * 100).toFixed(2);

            // Display results
            document.getElementById('monthlyPayment').textContent = `$${monthlyPayment.toFixed(2)}`;
            document.getElementById('totalInterest').textContent = `$${totalInterest.toFixed(2)}`;
            document.getElementById('totalAmount').textContent = `$${totalAmount.toFixed(2)}`;
            document.getElementById('monthlyRate').textContent = `${(monthlyRate * 100).toFixed(4)}%`;
            document.getElementById('numPayments').textContent = numPayments;
            document.getElementById('interestRatio').textContent = `${interestRatio}%`;

            document.getElementById('paymentResults').style.display = 'block';

            // Generate amortization data
            generateAmortizationSchedule(loanAmount, monthlyRate, numPayments, monthlyPayment);
        }

        function generateAmortizationSchedule(principal, monthlyRate, numPayments, monthlyPayment) {
            currentAmortizationData = [];
            let balance = principal;
            const tbody = document.getElementById('amortizationBody');
            tbody.innerHTML = '';

            for (let paymentNum = 1; paymentNum <= numPayments; paymentNum++) {
                const interest = balance * monthlyRate;
                const principalPaid = monthlyPayment - interest;
                balance -= principalPaid;

                if (balance < 0) balance = 0;

                const row = {
                    paymentNum,
                    payment: monthlyPayment,
                    principal: principalPaid,
                    interest,
                    balance: Math.max(0, balance)
                };

                currentAmortizationData.push(row);

                // Show first 12 payments and last 12 payments
                if (paymentNum <= 12 || paymentNum > numPayments - 12 || paymentNum % 12 === 0) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${paymentNum}</td>
                        <td>$${monthlyPayment.toFixed(2)}</td>
                        <td>$${principalPaid.toFixed(2)}</td>
                        <td>$${interest.toFixed(2)}</td>
                        <td>$${Math.max(0, balance).toFixed(2)}</td>
                    `;
                    tbody.appendChild(tr);
                }
            }

            document.getElementById('downloadBtn').style.display = 'block';
        }

        function downloadAmortization() {
            if (currentAmortizationData.length === 0) {
                MultiTools.showError('No amortization data available.');
                return;
            }

            let csv = 'Payment #,Payment,Principal,Interest,Balance\n';
            currentAmortizationData.forEach(row => {
                csv += `${row.paymentNum},$${row.payment.toFixed(2)},$${row.principal.toFixed(2)},$${row.interest.toFixed(2)},$${row.balance.toFixed(2)}\n`;
            });

            MultiTools.downloadFile(csv, 'amortization-schedule.csv', 'text/csv');
        }

        function calculateAffordability() {
            const monthlyIncome = parseFloat(document.getElementById('monthlyIncome').value);
            const downPayment = parseFloat(document.getElementById('downPayment').value);
            const annualRate = parseFloat(document.getElementById('affordabilityRate').value);
            const loanTerm = parseFloat(document.getElementById('loanTermAfford').value);

            if (!monthlyIncome || !downPayment || !annualRate || !loanTerm) {
                MultiTools.showError('Please fill in all required fields.');
                return;
            }

            const monthlyRate = annualRate / 100 / 12;
            const numPayments = loanTerm * 12;

            // Calculate maximum monthly payment (28% of income)
            const maxMonthlyPayment = monthlyIncome * 0.28;

            // Calculate maximum loan amount
            const maxLoanAmount = maxMonthlyPayment * ((Math.pow(1 + monthlyRate, numPayments) - 1) / 
                               (monthlyRate * Math.pow(1 + monthlyRate, numPayments)));

            const maxHomePrice = maxLoanAmount + downPayment;
            const dtiRatio = ((maxMonthlyPayment / monthlyIncome) * 100).toFixed(1);
            const recommendedPrice = maxHomePrice * 0.9; // 10% buffer
            const incomeNeeded = (maxMonthlyPayment / 0.28).toFixed(2);

            // Display results
            document.getElementById('maxHomePrice').textContent = `$${maxHomePrice.toFixed(2)}`;
            document.getElementById('maxLoanAmount').textContent = `$${maxLoanAmount.toFixed(2)}`;
            document.getElementById('affordabilityPayment').textContent = `$${maxMonthlyPayment.toFixed(2)}`;
            document.getElementById('dtiRatio').textContent = `${dtiRatio}%`;
            document.getElementById('recommendedPrice').textContent = `$${recommendedPrice.toFixed(2)}`;
            document.getElementById('incomeNeeded').textContent = `$${incomeNeeded}`;

            document.getElementById('affordabilityResults').style.display = 'block';
        }

        function resetPayment() {
            document.getElementById('loanAmount').value = '';
            document.getElementById('interestRate').value = '';
            document.getElementById('loanTerm').value = '';
            document.getElementById('paymentResults').style.display = 'none';
            document.getElementById('amortizationBody').innerHTML = '';
            document.getElementById('downloadBtn').style.display = 'none';
            currentAmortizationData = [];
        }

        function resetAffordability() {
            document.getElementById('monthlyIncome').value = '';
            document.getElementById('downPayment').value = '';
            document.getElementById('affordabilityRate').value = '';
            document.getElementById('loanTermAfford').value = '30';
            document.getElementById('affordabilityResults').style.display = 'none';
        }

        // Initialize tool
        document.addEventListener('DOMContentLoaded', function() {
            // Load header and footer
            loadHeader();
            loadFooter();
        });
    </script>
</body>
</html> 