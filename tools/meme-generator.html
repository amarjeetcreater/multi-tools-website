<script>
// Theme detection and application script
try {
    const userTheme = localStorage.getItem('theme');
    const systemTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    const theme = userTheme || systemTheme || 'light';
    document.documentElement.setAttribute('data-theme', theme);
} catch (e) {
    document.documentElement.setAttribute('data-theme', 'light');
}
</script>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meme Generator - Multi-Tools</title>
    <meta name="description" content="Create memes with custom text and images. Add top and bottom text to any image to make your own memes.">
    <meta name="keywords" content="meme generator, meme maker, create memes, custom memes, image editor, meme text">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../css/style.css">
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXX"
    crossorigin="anonymous"></script>
</head>
<body>
    <!-- Header Placeholder -->
    <div id="header-placeholder"></div>

    <div class="container mt-4">
        <div class="row">
            <div class="col-lg-8">
                <div class="tool-container">
                    <h1 class="tool-title">
                        <i class="fas fa-laugh-squint"></i> Meme Generator
                    </h1>
                    <p class="tool-description">
                        Create hilarious memes with custom text and images. Add top and bottom text to any image 
                        to make your own viral memes.
                    </p>

                    <div class="card">
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="imageInput" class="form-label">Upload Image</label>
                                <input type="file" class="form-control" id="imageInput" accept="image/*">
                                <div class="form-text">Choose an image from your device or use a sample image</div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="topText" class="form-label">Top Text</label>
                                        <input type="text" class="form-control" id="topText" 
                                               placeholder="Enter top text">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="bottomText" class="form-label">Bottom Text</label>
                                        <input type="text" class="form-control" id="bottomText" 
                                               placeholder="Enter bottom text">
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="textColor" class="form-label">Text Color</label>
                                        <input type="color" class="form-control form-control-color" id="textColor" 
                                               value="#ffffff" title="Choose text color">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="fontSize" class="form-label">Font Size</label>
                                        <input type="range" class="form-range" id="fontSize" 
                                               min="20" max="80" value="40">
                                        <div class="text-center mt-1">
                                            <span id="fontSizeDisplay">40</span>px
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="d-grid gap-2 d-md-flex justify-content-md-start">
                                <button class="btn btn-primary" onclick="generateMeme()">
                                    <i class="fas fa-magic"></i> Generate Meme
                                </button>
                                <button class="btn btn-secondary" onclick="loadSampleImage()">
                                    <i class="fas fa-image"></i> Sample Image
                                </button>
                                <button class="btn btn-outline-secondary" onclick="clearMeme()">
                                    <i class="fas fa-eraser"></i> Clear
                                </button>
                            </div>
                        </div>
                    </div>

                    <div id="resultContainer" class="mt-4" style="display: none;">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0">Generated Meme</h5>
                            </div>
                            <div class="card-body text-center">
                                <div id="memeOutput" class="position-relative d-inline-block"></div>
                                <div class="mt-3">
                                    <button class="btn btn-success" onclick="downloadMeme()">
                                        <i class="fas fa-download"></i> Download Meme
                                    </button>
                                    <button class="btn btn-info" onclick="shareMeme()">
                                        <i class="fas fa-share"></i> Share
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="sidebar">
                    <div class="card mb-4">
                        <div class="card-header">
                            <h5><i class="fas fa-info-circle"></i> Meme Tips</h5>
                        </div>
                        <div class="card-body">
                            <ul class="list-unstyled">
                                <li>• Keep text short and impactful</li>
                                <li>• Use contrasting colors</li>
                                <li>• Position text for readability</li>
                                <li>• Consider image composition</li>
                                <li>• Test different font sizes</li>
                                <li>• Use popular meme formats</li>
                            </ul>
                        </div>
                    </div>

                    <div class="card mb-4">
                        <div class="card-header">
                            <h5><i class="fas fa-lightbulb"></i> Popular Meme Formats</h5>
                        </div>
                        <div class="card-body">
                            <ul class="list-unstyled">
                                <li>• "One does not simply..."</li>
                                <li>• "Success Kid"</li>
                                <li>• "Grumpy Cat"</li>
                                <li>• "Distracted Boyfriend"</li>
                                <li>• "Drake Hotline Bling"</li>
                                <li>• "Two Buttons"</li>
                            </ul>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-ad"></i> Ad Space</h5>
                        </div>
                        <div class="card-body">
                            <div class="ad-placeholder">
                                <p class="text-muted text-center">Advertisement</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="../js/main.js"></script>
    
    <script>
        let currentImage = null;
        let memeCanvas = null;

        // Update font size display
        document.getElementById('fontSize').addEventListener('input', function() {
            document.getElementById('fontSizeDisplay').textContent = this.value;
        });

        // Load image when file is selected
        document.getElementById('imageInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                loadImage(file);
            }
        });

        function loadImage(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                currentImage = new Image();
                currentImage.onload = function() {
                    MultiTools.showSuccess('Image loaded successfully!');
                };
                currentImage.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function loadSampleImage() {
            // Create a sample image (placeholder)
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 400;
            canvas.height = 300;
            
            // Draw a simple placeholder
            ctx.fillStyle = '#f0f0f0';
            ctx.fillRect(0, 0, 400, 300);
            ctx.fillStyle = '#666';
            ctx.font = '20px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Sample Meme Image', 200, 150);
            
            // Convert to data URL
            currentImage = new Image();
            currentImage.onload = function() {
                MultiTools.showSuccess('Sample image loaded!');
            };
            currentImage.src = canvas.toDataURL();
        }

        function generateMeme() {
            if (!currentImage) {
                MultiTools.showError('Please upload or select an image first');
                return;
            }

            const topText = document.getElementById('topText').value;
            const bottomText = document.getElementById('bottomText').value;
            const textColor = document.getElementById('textColor').value;
            const fontSize = parseInt(document.getElementById('fontSize').value);

            if (!topText && !bottomText) {
                MultiTools.showError('Please enter at least one text line');
                return;
            }

            // Create canvas
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas size
            canvas.width = currentImage.width;
            canvas.height = currentImage.height;
            
            // Draw image
            ctx.drawImage(currentImage, 0, 0);
            
            // Configure text
            ctx.fillStyle = textColor;
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 3;
            ctx.font = `bold ${fontSize}px Impact, Arial, sans-serif`;
            ctx.textAlign = 'center';
            
            // Draw top text
            if (topText) {
                const y = fontSize + 10;
                ctx.strokeText(topText.toUpperCase(), canvas.width / 2, y);
                ctx.fillText(topText.toUpperCase(), canvas.width / 2, y);
            }
            
            // Draw bottom text
            if (bottomText) {
                const y = canvas.height - 10;
                ctx.strokeText(bottomText.toUpperCase(), canvas.width / 2, y);
                ctx.fillText(bottomText.toUpperCase(), canvas.width / 2, y);
            }
            
            // Display result
            const outputDiv = document.getElementById('memeOutput');
            outputDiv.innerHTML = '';
            outputDiv.appendChild(canvas);
            
            memeCanvas = canvas;
            document.getElementById('resultContainer').style.display = 'block';
            MultiTools.showSuccess('Meme generated successfully!');
        }

        function downloadMeme() {
            if (!memeCanvas) {
                MultiTools.showError('No meme to download');
                return;
            }

            const link = document.createElement('a');
            link.download = 'meme.png';
            link.href = memeCanvas.toDataURL();
            link.click();
            
            MultiTools.showSuccess('Meme downloaded successfully!');
        }

        function shareMeme() {
            if (!memeCanvas) {
                MultiTools.showError('No meme to share');
                return;
            }

            // Convert canvas to blob for sharing
            memeCanvas.toBlob(function(blob) {
                if (navigator.share) {
                    const file = new File([blob], 'meme.png', { type: 'image/png' });
                    navigator.share({
                        title: 'My Meme',
                        text: 'Check out this meme I created!',
                        files: [file]
                    }).then(() => {
                        MultiTools.showSuccess('Meme shared successfully!');
                    }).catch(() => {
                        MultiTools.showError('Failed to share meme');
                    });
                } else {
                    // Fallback: copy to clipboard
                    const dataURL = memeCanvas.toDataURL();
                    navigator.clipboard.writeText(dataURL).then(() => {
                        MultiTools.showSuccess('Meme URL copied to clipboard!');
                    }).catch(() => {
                        MultiTools.showError('Failed to copy meme');
                    });
                }
            });
        }

        function clearMeme() {
            document.getElementById('imageInput').value = '';
            document.getElementById('topText').value = '';
            document.getElementById('bottomText').value = '';
            document.getElementById('textColor').value = '#ffffff';
            document.getElementById('fontSize').value = 40;
            document.getElementById('fontSizeDisplay').textContent = '40';
            document.getElementById('resultContainer').style.display = 'none';
            currentImage = null;
            memeCanvas = null;
            MultiTools.showSuccess('Meme cleared');
        }

        // Load components when page loads
        document.addEventListener('DOMContentLoaded', function() {
            MultiTools.loadHeader();
            MultiTools.loadFooter();
        });
    </script>
</body>
</html> 